<div class="pb-48 grid grid-cols-12 gap-4">

  <div class="col-span-12 xl:col-span-2">

    <utility-back-link-component></utility-back-link-component>

  </div>

  <ng-container *ngIf="item$ | async as event">

    <div class="col-span-12 xl:col-start-3 xl:col-span-8 2xl:col-start-4 2xl:col-span-6 flex flex-col gap-4">

      <card gap="8">

        <div class="flex justify-between items-center">

          <div class="text-2xl font-bold text-beeColor-500">{{ 'general.details' | translate }}</div>
          <div event-status-style [status]="event.status"></div>

        </div>

        <div>

          <div class="font-bold text-beeColor-400 mb-2">{{ 'keyword.capitalize.service' | translate }}:</div>

          <div class="grid grid-cols-12 gap-4">

            <div class="col-span-12 md:col-span-3">
              <div
                class="md:min-w-[128px] md:max-w-[128px] md:min-h-[128px] md:max-h-[128px] rounded-2xl bg-beeColor-400">
                <img *ngIf="event.services?.[0]?.presentation?.main" [src]="event.services?.[0]?.presentation?.main"
                     class="object-cover rounded-2xl md:min-w-[128px] md:max-w-[128px] md:min-h-[128px] md:max-h-[128px]"
                     alt="Uploaded Image"/>
              </div>
            </div>
            <div class="col-span-12 md:col-span-9">
              <div class="flex flex-col gap-2">
                <div
                  class="text-xl font-bold text-beeColor-600">{{ event.services?.[0]?.languageVersions?.[0]?.title }}</div>
                <div class="grid grid-cols-12 gap-4">

                  <div class="col-span-12 md:col-span-9">

                    <div class="text-beeColor-500">{{ event.services?.[0]?.languageVersions?.[0]?.description }}</div>

                  </div>

                  <div class="col-span-12 md:col-span-3">

                    <div class="flex flex-col gap-1">

                      <div class="text-end font-bold">
                        {{ event.services?.[0]?.durationVersions?.[0]?.prices?.[0]?.price | currency: event.services?.[0]?.durationVersions?.[0]?.prices?.[0]?.currency: 'symbol-narrow' }}
                      </div>
                      <div class="text-end">
                        {{ formatDuration(event.services?.[0]?.durationVersions?.[0]?.duration ?? '') }}
                      </div>

                    </div>

                  </div>
                </div>
              </div>
            </div>

          </div>

        </div>

        <div class="flex flex-col gap-3">

          <div class="font-bold text-beeColor-400">{{ 'general.clients' | translate }}:</div>

          <div class="grid grid-cols-12 gap-4" *ngFor="let attendant of event.attendees; let index = index;">
            <div class="col-span-1 text-beeColor-400">
              #{{ index + 1 }}
            </div>
            <div class="col-span-3">
              {{ attendant.customer.firstName }} {{ attendant.customer.lastName }}
            </div>
            <div class="col-span-5">
              {{ attendant.customer.email }}
            </div>
            <div class="col-span-3">
              {{ attendant.customer.phone }}
            </div>
          </div>

        </div>

        <div class="flex flex-col gap-3">

          <div class="font-bold text-beeColor-400">{{ 'keyword.capitalize.dateAndTime' | translate }}:</div>

          <div>
            {{ event.start ?? '' | dynamicDate: 'medium' }}
          </div>

        </div>

        <div class="flex flex-col gap-3">

          <div class="font-bold text-beeColor-400">{{ 'keyword.capitalize.note' | translate }}:</div>

          <div>
            {{ event.description }}
          </div>

        </div>

      </card>

      <card>

        <div class="flex justify-between flex-col md:flex-row gap-4">

          <ng-container *ngIf="isRequested(event.status)">

            <ng-container *ngTemplateOutlet="ButtonToCancelEvent"></ng-container>

            <edit-link-component class="w-full" [buttonWidthFull]="true"></edit-link-component>

            <ng-container *ngTemplateOutlet="ButtonToBookEvent"></ng-container>

          </ng-container>

          <ng-container *ngIf="isBooked(event.status)">

            <ng-container *ngTemplateOutlet="ButtonToCancelEvent"></ng-container>

            <edit-link-component class="w-full" [buttonWidthFull]="true"></edit-link-component>

            <ng-container *ngTemplateOutlet="ButtonToDoneEvent"></ng-container>

          </ng-container>

          <ng-container *ngIf="isDone(event.status)">

            <ng-container *ngTemplateOutlet="ButtonToRepeatEvent"></ng-container>

          </ng-container>

          <ng-container *ngIf="isCancelled(event.status)">

            <ng-container *ngTemplateOutlet="ButtonToRepeatEvent"></ng-container>

          </ng-container>

          <ng-template #ButtonToCancelEvent>
            <button (click)="changeStatusOnCancelled(event)" class="
              w-full
              flex
              items-center
              justify-center
              gap-2
              rounded-2xl
              px-3
              py-2
              text-sm
              font-semibold
              text-red-700
              bg-red-50
              shadow-sm
              ring-1
              ring-inset
              ring-red-300
              hover:bg-red-100">
              <i class="bi bi-x-lg"></i>
              {{ 'keyword.capitalize.cancel' | translate }}
            </button>
          </ng-template>

          <ng-template #ButtonToBookEvent>
            <button (click)="changeStatusOnBooked(event)" class="
              w-full
              flex
              items-center
              justify-center
              gap-2
              rounded-2xl
              px-3
              py-2
              text-sm
              font-semibold
              text-blue-700
              bg-blue-50
              shadow-sm
              ring-1
              ring-inset
              ring-blue-300
              hover:bg-blue-100">
              <i class="bi bi-check-lg"></i>
              {{ 'keyword.capitalize.approve' | translate }}
            </button>
          </ng-template>

          <ng-template #ButtonToDoneEvent>
            <button (click)="changeStatusOnDone(event)" class="
              w-full
              flex
              items-center
              justify-center
              gap-2
              rounded-2xl
              px-3
              py-2
              text-sm
              font-semibold
              text-green-700
              bg-green-50
              shadow-sm
              ring-1
              ring-inset
              ring-green-300
              hover:bg-green-100">
              <i class="bi bi-check-lg"></i>
              {{ 'keyword.capitalize.done' | translate }}
            </button>
          </ng-template>

          <ng-template #ButtonToRepeatEvent>
            <a routerLink="repeat" class="
              w-full
              flex
              items-center
              justify-center
              gap-2
              rounded-2xl
              px-3
              py-2
              text-sm
              font-semibold
              text-blue-700
              shadow-sm
              ring-1
              ring-inset
              ring-blue-300
              hover:bg-blue-100">
              <i class="bi bi-arrow-repeat"></i>
              {{ 'event.keyword.capitalize.repeat' | translate }}
            </a>
          </ng-template>

        </div>
      </card>

    </div>

    <div class="col-span-12 xl:col-span-2 text-end text-beeColor-400 text-sm">

      <div class="flex flex-col gap-4">

        <div class="flex flex-col">

          <div>
            {{ 'keyword.capitalize.service' | translate }}:
          </div>
          <div>
            {{ event._id }}
          </div>

        </div>

        <div class="flex flex-col">

          <div>
            {{ 'keyword.capitalize.createdAt' | translate }}:
          </div>
          <div>
            {{ event.createdAt | dynamicDate }}
          </div>

        </div>

        <div class="flex flex-col">

          <div>
            {{ 'keyword.capitalize.updatedAt' | translate }}:
          </div>
          <div>
            {{ event.updatedAt | dynamicDate }}
          </div>

        </div>

      </div>

    </div>

  </ng-container>

</div>
