<div class="row mb-3">
  <div class="col-12 d-flex justify-content-between">
    <service-filter-component></service-filter-component>
    <utility-popover id="list-menu">
      <i button class="bi bi-three-dots-vertical"></i>
      <ul content class="list-group border-0">
        <li
          routerLink="form"
          close-on-self-click
          class="list-group-item list-group-item-action cursor-pointer border-0">
          <i class="bi bi-plus-lg"></i>
          Add new service
        </li>
      </ul>
    </utility-popover>
  </div>
</div>

<div class="relative overflow-x-auto">
  <table class="w-full text-sm text-left text-grey-500 dark:text-grey-400">
    <thead class="text-xs text-grey-700 uppercase border-b dark:bg-grey-700 dark:text-grey-400">
    <tr>
      <th scope="col" class="p-4">
        <div class="flex items-center">
          <input id="checkbox-all" type="checkbox"
                 class="w-4 h-4 text-blue-600 bg-grey-100 border-grey-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-grey-800 dark:focus:ring-offset-grey-800 focus:ring-2 dark:bg-grey-700 dark:border-grey-300">
          <label for="checkbox-all" class="sr-only">checkbox</label>
        </div>
      </th>
      <th scope="col" class="px-6 py-3 cursor-pointer" (click)="repository.pagination.setOrderBy('languageVersions.title')">
        Full name
        <i class="bi"
           *ngIf="repository.pagination.orderBy === 'languageVersions.title'"
           [class.bi-sort-alpha-down]="repository.pagination.orderDir === 'asc'"
           [class.bi-sort-alpha-up]="repository.pagination.orderDir === 'desc'"></i>
      </th>
      <th scope="col" class="px-6 py-3 cursor-pointer">
        Languages
      </th>
      <th scope="col" class="px-6 py-3 cursor-pointer">
        Employees
      </th>
      <th scope="col" class="px-6 py-3 cursor-pointer" (click)="repository.pagination.setOrderBy('email')">
        Active
        <utility-sort-indicator
          [show]="repository.pagination.orderBy === 'active'"
          [asc]="repository.pagination.orderDir === 'asc'"
        ></utility-sort-indicator>
      </th>
      <th scope="col" class="px-6 py-3 cursor-pointer" (click)="repository.pagination.setOrderBy('createdAt')">
        Created At
        <utility-sort-indicator
          [show]="repository.pagination.orderBy === 'createdAt'"
          [asc]="repository.pagination.orderDir === 'asc'"
        ></utility-sort-indicator>
      </th>
      <th scope="col" class="px-6 py-3 cursor-pointer" (click)="repository.pagination.setOrderBy('updatedAt')">
        Updated At
        <utility-sort-indicator
          [show]="repository.pagination.orderBy === 'updatedAt'"
          [asc]="repository.pagination.orderDir === 'asc'"
        ></utility-sort-indicator>
      </th>
      <th scope="col" class="px-6 py-3">
        Action
      </th>
    </tr>
    </thead>
    <tbody>
    <tr
      class="bg-white border-b dark:bg-grey-800 dark:border-grey-700 hover:bg-grey-100 dark:hover:bg-grey-300"
      *ngFor="let item of repository.pagination.items">
      <td class="w-4 p-4">
        <div class="flex items-center">
          <input id="checkbox-table-1" type="checkbox"
                 class="w-4 h-4 text-blue-600 bg-grey-100 border-grey-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-grey-800 dark:focus:ring-offset-grey-800 focus:ring-2 dark:bg-grey-700 dark:border-grey-300">
          <label for="checkbox-table-1" class="sr-only">checkbox</label>
        </div>
      </td>
      <td class="px-6 py-4 text-grey-700 dark:text-gray-100">
        <a [routerLink]="['details', item._id]">
          {{ getFirstLanguageVersion(item.languageVersions).title }}
        </a>
      </td>
      <td class="px-6 py-4 text-grey-700 dark:text-gray-100">
        {{ getLanguageCodes(item.languageVersions) }}
      </td>
      <td class="px-6 py-4 text-grey-700 dark:text-gray-100">
        <i class="bi bi-person"></i>
        {{ item?.permanentEmployees?.length ?? 0 }}
      </td>
      <td class="px-6 py-4 text-grey-700 dark:text-gray-100">
        <span
          [class.text-danger]="!item.active"
          [class.text-success]="item.active">
          {{ item.active ? 'active' : 'Inactive' }}
        </span>
      </td>
      <td class="px-6 py-4 text-grey-700 dark:text-gray-100">
        {{ item.createdAt | date: 'hh:mm dd-MM-yyyy' }}
      </td>
      <td class="px-6 py-4 text-grey-700 dark:text-gray-100">
        {{ item.updatedAt | date: 'hh:mm dd-MM-yyyy' }}
      </td>
      <td>
        <utility-popover id="table-row-{{ item._id }}">
          <i button class="bi bi-three-dots-vertical"></i>
          <ul content class="list-group border-0">
            <li
              [routerLink]="['details', item._id]"
              close-on-self-click
              class="list-group-item list-group-item-action cursor-pointer border-0">
              <i class="bi bi-eye"></i>
              Details
            </li>
            <li
              [routerLink]="['form', item._id]"
              close-on-self-click
              class="list-group-item list-group-item-action cursor-pointer border-0">
              <i class="bi bi-pencil"></i>
              Edit
            </li>
            <li
              (click)="repository.delete(item._id, true)"
              close-on-self-click
              class="list-group-item list-group-item-action cursor-pointer border-0">
              <i class="bi bi-trash"></i>
              Delete
            </li>
          </ul>
        </utility-popover>
      </td>
    </tr>

    </tbody>
  </table>
</div>
<utility-pagination-component [pagination]="repository.pagination"></utility-pagination-component>
