<div class="row mb-3">
  <div class="col-12 d-flex justify-content-between">
    <service-filter-component></service-filter-component>
    <utility-popover id="list-menu">
      <i button class="bi bi-three-dots-vertical"></i>
      <ul content class="list-group border-0">
        <li
          routerLink="form"
          close-on-self-click
          class="list-group-item list-group-item-action cursor-pointer border-0">
          <i class="bi bi-plus-lg"></i>
          Add new service
        </li>
      </ul>
    </utility-popover>
  </div>
</div>

<utility-table-component>
  <thead utility-header-table-component>
  <tr>
    <th class="sort pe-1 align-middle white-space-nowrap cursor-pointer" (click)="repository.pagination.setOrderBy('languageVersions.title')">
      Title
      <i class="bi"
         *ngIf="repository.pagination.orderBy === 'languageVersions.title'"
         [class.bi-sort-alpha-down]="repository.pagination.orderDir === 'asc'"
         [class.bi-sort-alpha-up]="repository.pagination.orderDir === 'desc'"></i>
    </th>
    <th class="sort pe-1 align-middle white-space-nowrap">
      Languages
    </th>
    <th class="sort pe-1 align-middle white-space-nowrap">
      Employees
    </th>
    <th class="sort pe-1 align-middle white-space-nowrap cursor-pointer" (click)="repository.pagination.setOrderBy('active')">
      Active
      <i class="bi"
         *ngIf="repository.pagination.orderBy === 'active'"
         [class.bi-sort-alpha-down]="repository.pagination.orderDir === 'asc'"
         [class.bi-sort-alpha-up]="repository.pagination.orderDir === 'desc'"></i>
    </th>
    <th class="sort pe-1 align-middle white-space-nowrap cursor-pointer" (click)="repository.pagination.setOrderBy('createdAt')">
      Created At
      <i class="bi"
         *ngIf="repository.pagination.orderBy === 'createdAt'"
         [class.bi-sort-alpha-down]="repository.pagination.orderDir === 'asc'"
         [class.bi-sort-alpha-up]="repository.pagination.orderDir === 'desc'"></i>
    </th>
    <th class="sort pe-1 align-middle white-space-nowrap cursor-pointer" (click)="repository.pagination.setOrderBy('updatedAt')">
      Updated At
      <i class="bi"
         *ngIf="repository.pagination.orderBy === 'updatedAt'"
         [class.bi-sort-alpha-down]="repository.pagination.orderDir === 'asc'"
         [class.bi-sort-alpha-up]="repository.pagination.orderDir === 'desc'"></i>
    </th>
    <th class="sort pe-1 align-middle white-space-nowrap">
      Action
    </th>
  </tr>
  </thead>
  <tbody utility-body-table-component [loader]="repository.loading" [pagination]="repository.pagination">
    <tr class="btn-reveal-trigger" *ngFor="let item of repository.pagination.items">
      <td class="align-middle white-space-nowrap">
        <a [routerLink]="['details', item._id]">
          {{ getFirstLanguageVersion(item.languageVersions).title }}
        </a>
      </td>
      <td class="align-middle white-space-nowrap">
        {{ getLanguageCodes(item.languageVersions) }}
      </td>
      <td class="align-middle white-space-nowrap">
        <i class="bi bi-person"></i>
        {{ item?.permanentEmployees?.length ?? 0 }}
      </td>
      <td class="align-middle white-space-nowrap">
        <span
          [class.text-danger]="!item.active"
          [class.text-success]="item.active">
          {{ item.active ? 'active' : 'Inactive' }}
        </span>
      </td>
      <td class="align-middle white-space-nowrap">
        {{ item.createdAt | date: 'hh:mm dd-MM-yyyy' }}
      </td>
      <td class="align-middle white-space-nowrap">
        {{ item.updatedAt | date: 'hh:mm dd-MM-yyyy' }}
      </td>
      <td>
        <utility-popover id="table-row-{{ item._id }}">
          <i button class="bi bi-three-dots-vertical"></i>
          <ul content class="list-group border-0">
            <li
              [routerLink]="['details', item._id]"
              close-on-self-click
              class="list-group-item list-group-item-action cursor-pointer border-0">
              <i class="bi bi-eye"></i>
              Details
            </li>
            <li
              [routerLink]="['form', item._id]"
              close-on-self-click
              class="list-group-item list-group-item-action cursor-pointer border-0">
              <i class="bi bi-pencil"></i>
              Edit
            </li>
            <li
              (click)="repository.delete(item._id, true)"
              close-on-self-click
              class="list-group-item list-group-item-action cursor-pointer border-0">
              <i class="bi bi-trash"></i>
              Delete
            </li>
          </ul>
        </utility-popover>
      </td>
    </tr>
  </tbody>
</utility-table-component>
<utility-pagination-component [pagination]="repository.pagination"></utility-pagination-component>
